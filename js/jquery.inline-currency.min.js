(function(d){const a="0.3.0";var c="$$jqueryInlineCurrency$$",b=null;var e={currency:"USD",convertTo:"EUR",thousandsSplit:"",decimalsSplit:".",containerElement:"p",containerClass:"jic-container",rateElement:"span",rateClass:"jic-rate",currencyElement:"span",currencyClass:"jic-currency",debug:false};var f=d.Deferred();d.fn.inlineCurrency=function(i){var m=this;i=d.extend(e,i);i.convertTo=k(i.convertTo);if(i.convertTo){i.convertTo=i.convertTo.sort().map(function(o){return o.toUpperCase()})}else{g("EXIT: options.convertTo must be specified");return false}if(!i.currency){g("EXIT: options.currency must be specified");return false}d.when(n()).then(function(){m.each(function(){l(d(this))})}).fail(function(){g("EXIT: couldn't update exchange rates");return false});return m;function n(){var o=JSON.parse(window.localStorage.getItem(c)),q=false;if(!o){q=true}else{if(!o.rates||!o.created||o.created<new Date().getTime()-86400000){q=true}if(!o.version||o.version!=a){q=true}}if(q){g("remove and update local exchange rates");window.localStorage.removeItem(c);var p=i.currency.toUpperCase();o={};d.getJSON("http://api.fixer.io/latest",{base:p},function(r){if(r.rates){o.created=new Date().getTime();r.rates[p]=1;o.rates=r.rates;o.version=a;window.localStorage.setItem(c,JSON.stringify(o));g("OK: rates updated");b=o;f.resolve(true)}},function(){g("WARNING: currency service temporary unavailable");f.reject(false)})}else{b=o;f.resolve(true)}return f.promise()}function g(){if(i.debug){if(!console){window.console={}}console.log("[jQueryInlineCurrency: ",d.makeArray(arguments).join(", "),"]")}}function k(o){if(o){if(typeof(o)!=="object"){return o.split(/,\s?/)}else{return o}}else{return false}}function j(o,q,p){o=o||0;q=q.toString().toUpperCase();p=p.toString().toUpperCase();if(b&&b.rates&&p&&b.rates[p]&&q&&b.rates[q]){return Math.round(o/b.rates[q]*b.rates[p]*100)/100}else{return false}}function h(o){var q=o.text();var p=new RegExp("(\\d+"+(i.thousandsSplit?"(?:\\"+i.thousandsSplit+"\\d+)*":"")+"(?:\\"+i.decimalsSplit+"\\d+)?)+").exec(q);return p&&p.length?p[0]:0}function l(r){var v="",o=r.html(),t=r.data("jic-value")||h(r),p=r.data("jic-currency")||i.currency,s=k(r.data("jic-convert-to")||i.convertTo);for(var q=0;q<s.length;q++){s[q]=d.trim(s[q]);p=d.trim(p);var u=j(t,p,s[q]);if(u){if(i.rateElement){v+="<"+i.rateElement+(i.rateClass?' class="'+i.rateClass+'"':"")+">"+u+" "+(i.currencyElement?"<"+i.currencyElement+(i.currencyClass?' class="'+i.currencyClass+'"':"")+">":"")+s[q].toUpperCase()+(i.currencyElement?"</"+i.currencyElement+">":"")+"</"+i.rateElement+">"}else{if(i.currencySplit){v+=(!v?"":", ")+u+" "+s[q].toUpperCase()}}}}if(v){if(i.containerElement){v="<"+i.containerElement+(i.containerClass?' class="'+i.containerClass+'"':"")+">"+v+"</"+i.containerElement+">"}r.append(d(v))}}}})(jQuery);