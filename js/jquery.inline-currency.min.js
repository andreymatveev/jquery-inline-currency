(function(f){const a="0.3.4";var e="$$jqueryInlineCurrency$$",b=null;var g={currency:"USD",convertTo:"EUR",thousandsSplit:"",decimalsSplit:".",containerElement:"p",containerClass:"jic-container",rateElement:"span",rateClass:"jic-rate",currencyElement:"span",currencyClass:"jic-currency",currencySplit:false,debug:false};var h=f.Deferred(),d=null,c=null;f.fn.inlineCurrency=function(r){var n=this;r=f.extend(g,r);r.convertTo=l(r.convertTo);if(r.thousandsSplit){d=q(r.thousandsSplit)}if(r.decimalsSplit){c=q(r.decimalsSplit)}if(r.convertTo){r.convertTo=r.convertTo.sort().map(function(s){return s.toUpperCase()})}else{j("EXIT: options.convertTo must be specified");return false}if(!r.currency){j("EXIT: options.currency must be specified");return false}f.when(p()).then(function(){n.each(function(){m(f(this))})}).fail(function(){j("EXIT: couldn't update exchange rates");return false});return n;function q(s){if(s){return s.replace(/[^\s\.,]/gi,"").replace(/\s+/gi,"\\s").replace(/\./gi,"\\.")}else{return""}}function p(){var s=JSON.parse(window.localStorage.getItem(e)),u=false;if(!s){u=true}else{if(!s.rates||!s.created||s.created<new Date().getTime()-86400000){u=true}if(!s.version||s.version!=a){u=true}}if(u){j("remove and update local exchange rates");window.localStorage.removeItem(e);var t=r.currency.toUpperCase();s={};f.getJSON("http://api.fixer.io/latest",{base:t},function(v){if(v.rates){s.created=new Date().getTime();v.rates[t]=1;s.rates=v.rates;s.version=a;window.localStorage.setItem(e,JSON.stringify(s));j("OK: rates updated");b=s;h.resolve(true)}},function(){j("WARNING: currency service temporary unavailable");h.reject(false)})}else{b=s;h.resolve(true)}return h.promise()}function j(){if(r.debug){if(!console){window.console={}}console.log("[jQueryInlineCurrency: ",f.makeArray(arguments).join(", "),"]")}}function l(s){if(s){if(typeof(s)!=="object"){return s.split(/,\s?/)}else{return s}}else{return false}}function o(s,u,t){s=s||0;u=u.toString().toUpperCase();t=t.toString().toUpperCase();if(b&&b.rates&&t&&b.rates[t]&&u&&b.rates[u]){return Math.round(s/b.rates[u]*b.rates[t]*100)/100}else{return false}}function k(t){var s=new RegExp("(\\d+"+(r.thousandsSplit?"(?:"+r.thousandsSplit+"\\d+)*":"")+"(?:"+r.decimalsSplit+"\\d+)?)+").exec(t);if(s&&s.length){if(d){s[0]=s[0].replace(new RegExp(d,"g"),"")}if(c){s[0]=s[0].replace(new RegExp(c,"g"),".")}return parseFloat(s[0])}return 0}function i(s){if(r.thousandsSplit){s=(s+"").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+r.thousandsSplit)}if(r.decimalsSplit){s=(s+"").replace(/(\d+)\.(\d+)/,"$1"+r.decimalsSplit+"$2")}return s}function m(v){var z="",s=v.html(),x=v.data("jic-value")||k(v.text()),t=v.data("jic-currency")||r.currency,w=l(v.data("jic-convert-to")||r.convertTo);for(var u=0;u<w.length;u++){w[u]=f.trim(w[u]);t=f.trim(t);var y=o(x,t,w[u]);if(y){if(!r.currencySplit){z+="<"+(r.rateElement||"span")+(r.rateClass?' class="'+r.rateClass+'"':"")+">"+i(y)+" "+(r.currencyElement?"<"+r.currencyElement+(r.currencyClass?' class="'+r.currencyClass+'"':"")+">":"")+w[u].toUpperCase()+(r.currencyElement?"</"+r.currencyElement+">":"")+"</"+(r.rateElement||"span")+">"}else{z+=(!z?"":", ")+i(y)+" "+w[u].toUpperCase()}}}if(z){if(r.containerElement){z="<"+(r.containerElement||"span")+(r.containerClass?' class="'+r.containerClass+'"':"")+">"+z+"</"+(r.containerElement||"span")+">"}v.append(f(z))}}}})(jQuery);